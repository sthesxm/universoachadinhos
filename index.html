<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Universo Promo e Achadinhos 💛🏠 | Entrar no Grupo</title>
  <link rel="preconnect" href="https://sndflw.com" crossorigin>

  <!-- Meta Pixel (dedupe PageView 1x por sessão + Advanced Matching) -->
  <script>
  !function(f,b,e,v,n,t,s){
    if(f.fbq) return;
    n=f.fbq=function(){ n.callMethod? n.callMethod.apply(n,arguments):n.queue.push(arguments) };
    if(!f._fbq) f._fbq=n;
    n.push=n; n.loaded=!0; n.version='2.0';
    n.queue=[];
    t=b.createElement(e); t.async=!0; t.src=v;
    s=b.getElementsByTagName(e)[0]; s.parentNode.insertBefore(t,s);
  }(window, document,'script','https://connect.facebook.net/en_US/fbevents.js');

  (function initPixelWithAdvancedMatching(){
    var PIXEL_ID = '734806152953802';

    function getParamOrStorage(key, storageKey){
      var params = new URLSearchParams(location.search);
      return params.get(key) || localStorage.getItem(storageKey || key) || '';
    }
    function normEmail(v){ return (v||'').toString().trim().toLowerCase(); }
    function normPhone(v){ return (v||'').toString().replace(/\D+/g,''); }

    try{
      var em = normEmail(getParamOrStorage('em','am_em'));
      var ph = normPhone(getParamOrStorage('ph','am_ph'));

      var advMatch = {};
      if (em) advMatch.em = em;
      if (ph) advMatch.ph = ph;

      fbq('init', PIXEL_ID, advMatch);
      fbq('set', 'autoConfig', false, PIXEL_ID);
    }catch(e){
      fbq('init', PIXEL_ID);
      fbq('set', 'autoConfig', false, PIXEL_ID);
    }
  })();

  (function sendPageViewOnce(){
    var nav = performance.getEntriesByType && performance.getEntriesByType('navigation')[0];
    var isBFCache = nav && nav.type === 'back_forward';
    var PV_KEY = 'pv_sent:' + location.pathname + ':' + (new Date()).toDateString();

    function cryptoRandomId(){
      var a = (self.crypto||{}).getRandomValues ? crypto.getRandomValues(new Uint8Array(16)) : Array.from({length:16},()=>Math.random()*256|0);
      a[6] = (a[6] & 0x0f) | 0x40;
      a[8] = (a[8] & 0x3f) | 0x80;
      var h = Array.from(a, b=>('0'+b.toString(16)).slice(-2)).join('');
      return h.slice(0,8)+'-'+h.slice(8,12)+'-'+h.slice(12,16)+'-'+h.slice(16,20)+'-'+h.slice(20);
    }

    function firePV(){
      if (sessionStorage.getItem(PV_KEY)) return;
      sessionStorage.setItem(PV_KEY, '1');
      try { fbq('track','PageView',{ event_id: 'pv-' + cryptoRandomId() }); } catch(e){}
    }

    if (document.prerendering) {
      document.addEventListener('prerenderingchange', function(){
        if (!isBFCache) firePV();
      }, { once:true });
    } else {
      if (!isBFCache) firePV();
    }
  })();
  </script>
  <!-- End Meta Pixel -->

  <style>
    :root{
      --pink:#4d046e;
      --pink-dark:#8d004c;
      --amber:#FFC107;
      --white:#ffffff;
      --gray:#555; --muted:#777;
      --shadow:0 10px 25px rgba(0,0,0,.1);
      --radius:18px;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;background:#fff;color:#222;padding-bottom:80px}

    header{
      background: linear-gradient(135deg, var(--pink) 0%, var(--pink-dark) 100%);
      padding:18px 18px 22px;text-align:center;border-radius:0 0 24px 24px;color:var(--white);
      box-shadow:var(--shadow);animation:hdrIn .6s ease both;
    }
    @keyframes hdrIn{from{opacity:0; transform:translateY(-8px)} to{opacity:1; transform:translateY(0)}}
    .logo-wrap{
      width:120px;height:120px;margin:0 auto 10px;border-radius:50%;background:#fff;display:flex;align-items:center;justify-content:center;box-shadow:0 8px 20px rgba(0,0,0,.2);overflow:hidden;
    }
    .logo-wrap img{width:100%;height:100%;object-fit:cover;object-position:center;border-radius:50%}
    h1{font-size:28px;font-weight:800;margin-bottom:4px}
    .subtitle{font-size:14px;color:#f1f1f1;margin-bottom:10px}

    .cta-section{text-align:center;margin:8px auto 0;padding:12px;max-width:700px;}
    .vacancy-wrap{max-width:600px;margin:4px auto 10px;text-align:center;}
    .vacancy-top{font-weight:800;font-size:16px;margin-bottom:6px;}
    .bar{width:100%;height:14px;background:#f9f9f9;border:2px solid #eee;border-radius:999px;position:relative;overflow:hidden}
    .bar>.fill{position:absolute;inset:0 100% 0 0;background:var(--amber);border-radius:999px;transition:inset .5s ease;overflow:hidden}
    .bar>.fill::after{content:"";position:absolute;top:0;bottom:0;left:-40%;width:40%;background:linear-gradient(120deg,transparent 0%,rgba(255,255,255,.4) 50%,transparent 100%);transform:skewX(-20deg);animation:barSheen 2.2s linear infinite;}
    @keyframes barSheen{from{left:-40%} to{left:110%}}

    .micro-trust{font-size:13.5px;font-weight:700;color:#666;margin:8px 0 10px 0;}

    .cta-btn{
      position:relative;overflow:hidden;display:inline-flex;align-items:center;justify-content:center;gap:10px;
      padding:14px 26px;width:100%;border-radius:999px;font-weight:900;font-size:17px;
      background:linear-gradient(180deg,var(--pink),var(--pink-dark));color:#fff;border:none;cursor:pointer;
      animation:zoomInCta .5s ease both,pulse 1.6s ease-in-out infinite;
      box-shadow:0 10px 25px rgba(141,0,76,.35);
      white-space:nowrap; /* mantém o texto em uma linha */
    }
    .cta-btn::after{content:"";position:absolute;top:0;bottom:0;left:-20%;width:20%;background:linear-gradient(120deg,transparent 0%,rgba(255,255,255,.45) 50%,transparent 100%);transform:skewX(-20deg);animation:shine 3.5s ease-in-out infinite;}
    @keyframes shine{0%,60%{left:-25%}70%,100%{left:110%}}
    .cta-btn:hover{filter:brightness(1.1);transform:scale(1.03)}
    .spinner{width:18px;height:18px;border:2px solid rgba(255,255,255,.35);border-top-color:#fff;border-radius:50%;display:none;animation:spin .7s linear infinite}
    .cta-btn.loading .spinner{display:inline-block}
    @keyframes spin{to{transform:rotate(360deg)}}
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.06)}}

    .trust-line{font-size:12px;color:#777;margin-top:8px;font-weight:600}

    .feed{margin:16px auto 10px;max-width:500px;background:#f7f7f7;border:1px solid #eaeaea;border-radius:14px;padding:10px}
    .notif{display:flex;align-items:center;gap:10px;background:#fff;padding:10px;border-radius:10px;margin-bottom:8px;border:1px solid #eee;font-size:13.5px;font-weight:600;opacity:0;transform:translateY(-16px);animation:slideDown .4s ease forwards}
    .notif .badge{background:rgba(46,204,113,.15);border:1px solid rgba(46,204,113,.3);color:#1e8e3e;font-weight:800;font-size:12px;padding:6px 8px;border-radius:999px}
    @keyframes slideDown{to{opacity:1;transform:translateY(0)}}

    .benefits{max-width:700px;margin:6px auto;padding:0 12px}
    .benefit{display:flex;align-items:center;gap:12px;background:rgba(77,4,110,0.08);border-radius:14px;padding:12px;margin-bottom:12px;border:1px solid var(--pink);box-shadow:0 4px 10px rgba(0,0,0,0.05);transform:translateY(10px);opacity:0}
    .emojibox{width:42px;height:42px;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,var(--pink),var(--pink-dark));border-radius:10px;font-size:20px;color:#fff}
    .benefit-text h4{font-size:16px;font-weight:800;margin-bottom:2px}
    .benefit-text p{font-size:13.5px;color:#777;margin:0}

    .sticky-footer{position:fixed;bottom:0;left:0;right:0;background:#111;color:#fff;padding:10px 14px;box-shadow:0 -8px 20px rgba(0,0,0,.2);display:flex;align-items:center;justify-content:space-between;z-index:50}
    .sticky-btn{background:linear-gradient(180deg,var(--pink),var(--pink-dark));color:#fff;border:none;border-radius:999px;padding:12px 20px;font-weight:800;font-size:14px;cursor:pointer;box-shadow:0 6px 16px rgba(141,0,76,.35);margin-left:8px;animation:footPulse 6s ease-in-out infinite;}
    @keyframes footPulse{0%,92%,100%{transform:scale(1)}95%{transform:scale(1.04)}98%{transform:scale(1.06)}}
  </style>
</head>
<body>
  <header>
    <div class="logo-wrap">
      <img src="https://i.postimg.cc/zXgQ7svW/Achadinhos.png" alt="Universo Promo e Achadinhos">
    </div>
    <h1>Universo Promo e Achadinhos 💛🏠</h1>
    <div class="subtitle">As melhores promoções de casa, cozinha, beleza, moda e mais no seu WhatsApp.</div>
  </header>

  <section class="cta-section">
    <div class="vacancy-wrap">
      <div class="vacancy-top"><span id="vacancyText">Últimas vagas de hoje • Restam 24 👇</span></div>
      <div class="bar"><div class="fill" id="fillBar"></div></div>
    </div>

    <div class="micro-trust">✅ +7.500 membros · 🎯 1 clique · 🚫 Sem spam</div>

    <button id="ctaMain" class="cta-btn" type="button">
      <span>ENTRAR GRÁTIS NO GRUPO</span>
      <span class="spinner" aria-hidden="true"></span>
    </button>

    <p class="trust-line">🔒 100% seguro · Link oficial do grupo · Nenhum dado é solicitado</p>

    <div class="feed" id="feed"></div>
  </section>

  <section class="benefits">
    <div class="benefit"><div class="emojibox">🔥</div><div class="benefit-text"><h4>Descontos Insanos</h4><p>Produtos com até 70% OFF</p></div></div>
    <div class="benefit"><div class="emojibox">🎟</div><div class="benefit-text"><h4>Cupons Exclusivos</h4><p>Só para membros do grupo</p></div></div>
    <div class="benefit"><div class="emojibox">👀</div><div class="benefit-text"><h4>Itens em Alta</h4><p>Os mais desejados do momento</p></div></div>
    <div class="benefit"><div class="emojibox">✅</div><div class="benefit-text"><h4>Ofertas Verificadas</h4><p>Promoções reais e testadas</p></div></div>
  </section>

  <div class="sticky-footer">
    <div>⏳ Últimas vagas de hoje</div>
    <button id="ctaFooter" class="sticky-btn" type="button">Entrar no grupo</button>
  </div>

  <!-- Script principal -->
  <script>
    function uuidv4(){
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {
        const r = Math.random()*16|0, v = c === 'x' ? r : (r&0x3|0x8);
        return v.toString(16);
      });
    }

    function boot(){
      const WHATS_LINK = "https://sndflw.com/i/universoachadinhos";

      const START_VACANCIES=24, MIN_VACANCIES=2;
      const feedEl=document.getElementById('feed');
      const vacancyText=document.getElementById('vacancyText');
      const fillBar=document.getElementById('fillBar');

      function updateVacancyUI(){
        vacancyText.textContent=`Últimas vagas de hoje • Restam ${START_VACANCIES} 👇`;
        fillBar.style.inset="0 0 0 0";
      }
      updateVacancyUI();

      // 🔒 Anti-duplicação de Lead por 30s (sessão) + envio com event_id
      const LEAD_LOCK_KEY = 'lead_lock_until';
      function canFireLead(){
        const now = Date.now();
        const lockUntil = parseInt(sessionStorage.getItem(LEAD_LOCK_KEY) || '0', 10);
        return now > lockUntil;
      }
      function setLeadLock(ms=30000){
        sessionStorage.setItem(LEAD_LOCK_KEY, String(Date.now() + ms));
      }
      function trackLeadOnce(){
        if (!canFireLead()) return null;
        setLeadLock(30000);
        const eventId = 'lead-' + uuidv4();
        try { fbq('track','Lead',{ event_id: eventId }); } catch(e){}
        return eventId;
      }

      function handleClick(e){
        const btn = e.currentTarget;
        if (btn.dataset.clicked === '1') return;
        btn.dataset.clicked = '1';
        btn.classList.add('loading');
        btn.setAttribute('disabled','true');

        // ✅ dispara LEAD antes do redirect
        trackLeadOnce();

        // ⏳ pequeno delay para garantir o envio do evento
        setTimeout(()=>{
          window.location.assign(WHATS_LINK);
        }, 250);

        setTimeout(()=>{
          btn.classList.remove('loading');
          btn.removeAttribute('disabled');
          btn.dataset.clicked = '0';
        }, 4000);
      }

      document.getElementById('ctaMain').addEventListener('click', handleClick);
      document.getElementById('ctaFooter').addEventListener('click', handleClick);
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', boot, { once:true });
    } else {
      boot();
    }
  </script>

  <noscript>
    <p style="text-align:center;margin-top:8px">
      <a href="https://sndflw.com/i/universoachadinhos">Entrar no grupo</a>
    </p>
  </noscript>
</body>
</html>

